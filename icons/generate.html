<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Generate Favicon PNGs</title>
    <style>
        body { font-family: system-ui; background: #1c1c1e; color: #fff; padding: 40px; }
        h1 { font-size: 24px; margin-bottom: 8px; }
        p { color: #999; margin-bottom: 24px; }
        .icon-grid { display: flex; flex-wrap: wrap; gap: 24px; margin-bottom: 32px; }
        .icon-item { text-align: center; }
        .icon-item canvas { border: 1px solid #333; border-radius: 8px; }
        .icon-item span { display: block; margin-top: 6px; font-size: 12px; color: #888; }
        a { color: #0a84ff; text-decoration: none; cursor: pointer; font-weight: 600; }
        a:hover { text-decoration: underline; }
        .btn { display: inline-block; padding: 10px 20px; background: #0a84ff; color: #fff; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; margin: 4px; }
        .btn:hover { background: #0070e0; }
        .status { margin-top: 16px; color: #30d158; font-size: 14px; }
    </style>
</head>
<body>
    <h1>GIS Toolbox — Generate Favicon PNGs</h1>
    <p>This page renders your icon.svg into all the required PNG sizes. Click each download link or use "Download All".</p>
    <button class="btn" onclick="downloadAll()">Download All PNGs</button>
    <div class="status" id="status"></div>
    <div class="icon-grid" id="grid"></div>

    <script>
        const sizes = [
            { name: 'favicon-16x16.png',          w: 16,  h: 16 },
            { name: 'favicon-32x32.png',          w: 32,  h: 32 },
            { name: 'apple-touch-icon.png',       w: 180, h: 180 },
            { name: 'icon-192x192.png',           w: 192, h: 192 },
            { name: 'icon-512x512.png',           w: 512, h: 512 },
            { name: 'icon-maskable-192x192.png',  w: 192, h: 192, maskable: true },
            { name: 'icon-maskable-512x512.png',  w: 512, h: 512, maskable: true },
        ];

        const grid = document.getElementById('grid');

        // Inline SVG sources as data URIs (avoids file:// CORS issues)
        const ICON_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><defs><linearGradient id="gold" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#e8b84a"/><stop offset="1" stop-color="#d4a24e"/></linearGradient><linearGradient id="bg" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#1a1d27"/><stop offset="1" stop-color="#0f1117"/></linearGradient></defs><circle cx="256" cy="256" r="256" fill="url(#bg)"/><circle cx="240" cy="272" r="160" fill="none" stroke="url(#gold)" stroke-width="8" opacity=".9"/><ellipse cx="240" cy="272" rx="80" ry="160" fill="none" stroke="url(#gold)" stroke-width="5" opacity=".7"/><line x1="80" y1="272" x2="400" y2="272" stroke="url(#gold)" stroke-width="5" opacity=".8"/><path d="M100 200h280" stroke="url(#gold)" stroke-width="3.5" opacity=".45"/><path d="M100 344h280" stroke="url(#gold)" stroke-width="3.5" opacity=".45"/><g transform="translate(350,120)"><path d="M0-52a44 44 0 0 1 44 44c0 28-44 72-44 72S-44 20-44-8a44 44 0 0 1 44-44z" fill="#e8b84a" stroke="#d4a24e" stroke-width="4"/><circle cx="0" cy="-8" r="16" fill="#0f1117"/><circle cx="0" cy="-8" r="7" fill="#e8b84a" opacity=".6"/></g></svg>`;

        const MASK_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><defs><linearGradient id="gold" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#e8b84a"/><stop offset="1" stop-color="#d4a24e"/></linearGradient></defs><rect width="512" height="512" fill="#0f1117"/><circle cx="240" cy="272" r="140" fill="none" stroke="url(#gold)" stroke-width="8" opacity=".9"/><ellipse cx="240" cy="272" rx="70" ry="140" fill="none" stroke="url(#gold)" stroke-width="5" opacity=".7"/><line x1="100" y1="272" x2="380" y2="272" stroke="url(#gold)" stroke-width="5" opacity=".8"/><path d="M115 210h250" stroke="url(#gold)" stroke-width="3.5" opacity=".45"/><path d="M115 334h250" stroke="url(#gold)" stroke-width="3.5" opacity=".45"/><g transform="translate(340,130)"><path d="M0-44a38 38 0 0 1 38 38c0 24-38 62-38 62S-38 18-38-6a38 38 0 0 1 38-38z" fill="#e8b84a" stroke="#d4a24e" stroke-width="3"/><circle cx="0" cy="-6" r="14" fill="#0f1117"/><circle cx="0" cy="-6" r="6" fill="#e8b84a" opacity=".6"/></g></svg>`;

        function svgToDataURL(svg) {
            return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
        }

        const iconSVG = new Image();
        const maskSVG = new Image();
        let loadedCount = 0;

        iconSVG.onload = maskSVG.onload = () => { if (++loadedCount >= 2) renderAll(); };
        iconSVG.src = svgToDataURL(ICON_SVG);
        maskSVG.src = svgToDataURL(MASK_SVG);

        function renderAll() {
            for (const s of sizes) {
                const canvas = document.createElement('canvas');
                canvas.width = s.w;
                canvas.height = s.h;
                const ctx = canvas.getContext('2d');
                const img = s.maskable ? maskSVG : iconSVG;
                ctx.drawImage(img, 0, 0, s.w, s.h);
                s.canvas = canvas;

                const div = document.createElement('div');
                div.className = 'icon-item';

                // Show preview (scaled up for small icons)
                const preview = document.createElement('canvas');
                const pSize = Math.max(s.w, 64);
                preview.width = pSize; preview.height = pSize;
                preview.style.width = pSize + 'px'; preview.style.height = pSize + 'px';
                const pctx = preview.getContext('2d');
                pctx.imageSmoothingEnabled = true;
                pctx.drawImage(canvas, 0, 0, pSize, pSize);
                div.appendChild(preview);

                const label = document.createElement('span');
                label.textContent = `${s.name} (${s.w}×${s.h})`;
                div.appendChild(label);

                const link = document.createElement('a');
                link.textContent = 'Download';
                link.onclick = () => downloadOne(s);
                div.appendChild(link);

                grid.appendChild(div);
            }
            document.getElementById('status').textContent = '✓ All icons rendered. Save them to the /icons/ folder.';
        }

        function downloadOne(s) {
            const a = document.createElement('a');
            a.download = s.name;
            a.href = s.canvas.toDataURL('image/png');
            a.click();
        }

        function downloadAll() {
            for (const s of sizes) {
                if (s.canvas) downloadOne(s);
            }
        }
    </script>
</body>
</html>
